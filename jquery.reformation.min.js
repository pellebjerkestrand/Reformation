/**
 *  jQuery Reformation v0.2
 *  Simple responsive image gallery plugin
 *  Named after Kiuas' Reformation - http://en.wikipedia.org/wiki/Reformation_(Kiuas_album)
 *
 *  By Pelle Bjerkestrand - http://pellebjerkestrand.net/
 *  License: UNLICENSE - http://unlicense.org/
 */(function(e){"use strict";e.fn.reform=function(t){if(this.length===0)return this;if(this.length>1){this.each(function(){e(this).reform(t)});return this}var n=this,r={gallery:".gallery",slide:".slide",next:".next",prev:".prev",title:".title",desc:".desc",url:".url",ratio:1,enableControls:!0,controls:".controls",auto:!1,speed:6e3,onLoad:function(){},onBefore:function(){},onAfter:function(){},onNext:function(){},onPrev:function(){}},i={settings:{},elements:{viewport:null,gallery:null,slides:null,controls:null,title:null,desc:null,url:null,contents:null},states:{controls:"controls",noControls:"no-controls",hidden:"hidden"},current:0,clickNext:function(){i.autoInterval&&clearInterval(i.autoInterval);i.next()},clickPrev:function(){i.autoInterval&&clearInterval(i.autoInterval);i.prev()},next:function(){i.settings.onNext(i.elements.slides.eq(i.current),i.current);var e=i.current+1;i.show(e>=i.elements.slides.length?0:e)},prev:function(){i.settings.onPrev(i.elements.slides.eq(i.current),i.current);var e=i.current-1;i.show(e<=-1?i.elements.slides.length-1:e)},show:function(e){i.settings.onBefore(i.elements.slides.eq(i.current),i.current);var t=i.elements.slides.eq(e).css({opacity:1,"z-index":2});i.elements.slides.not(t).css({opacity:0,"z-index":1});i.current=e;i.settings.onAfter(i.elements.slides.eq(i.current),i.current);i.updateInfo(t)},centerContent:function(){var e=i.elements.gallery.height(),t=i.elements.gallery.width(),n=t/e;if(n===i.settings.ratio)i.elements.contents.css({"margin-top":0,"margin-left":0,height:e,width:t});else if(n<i.settings.ratio){var r=e*i.settings.ratio;i.elements.contents.css({"margin-top":0,"margin-left":"-"+(r-t)/2+"px",height:e,width:r})}else{var s=t*i.settings.ratio;i.elements.contents.css({"margin-top":"-"+(s-e)/2+"px","margin-left":0,height:s,width:t})}},setInitialStyles:function(){i.elements.slides.css({display:"block",margin:0,overflow:"hidden",padding:0,position:"absolute",top:0,transition:"opacity 1.5s ease-in-out"});i.elements.viewport.css({height:"100%",position:"relative"});i.elements.gallery.css({bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0})},bindControls:function(){if(i.settings.enableControls){i.elements.controls=i.elements.viewport.find(i.settings.controls);i.elements.controls.find(i.settings.next).off("click").on("click",function(e){i.clickNext();e.preventDefault()});i.elements.controls.find(i.settings.prev).off("click").on("click",function(e){i.clickPrev();e.preventDefault()});i.elements.url=i.elements.viewport.find(i.settings.url).off("click").on("click",function(e){this.getAttribute("href")==="#"&&e.preventDefault()});i.elements.title=i.elements.viewport.find(i.settings.title);i.elements.desc=i.elements.viewport.find(i.settings.desc);i.elements.viewport.addClass(i.states.controls)}else i.elements.viewport.addClass(i.states.noControls)},hideControls:function(){i.elements.controls.find(i.settings.next+", "+i.settings.previous).addClass(i.states.hidden)},startAuto:function(){i.settings.auto&&!i.autoInterval&&(i.autoInterval=setInterval(function(){i.next()},i.settings.speed))},autoInterval:null,updateInfo:function(e){if(i.settings.enableControls){i.elements.title.text(e.data("reformation-title")||"");i.elements.desc.text(e.data("reformation-desc")||"");i.elements.url.attr("href",e.data("reformation-url")||"#")}e.data("reformation-alternate")?i.elements.viewport.addClass("alternate"):i.elements.viewport.removeClass("alternate")},init:function(){if(!i.elements.slides){e.extend(i.settings,r,t);i.elements.viewport=n;i.elements.gallery=i.elements.viewport.find(i.settings.gallery);i.elements.slides=i.elements.viewport.find(i.settings.slide);i.elements.contents=i.elements.slides.children();i.bindControls();i.setInitialStyles();i.show(i.current);i.centerContent();i.elements.slides.length>1?i.startAuto():i.hideControls();e(window).bind("resize",function(){i.centerContent()});i.settings.onLoad(i.elements.slides.eq(i.current),i.current)}}};n.next=function(){i.next()};n.prev=function(){i.prev()};n.show=function(e){i.show(e)};n.current=function(){return i.current};n.slide=function(e){return i.slides.eq(e)};i.init();return n}})(jQuery);